# tf.version == '2.1.0'



# 模型 summary
```python
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
user_click_item_seq_input_layer [(None, 50)]         0                                            
__________________________________________________________________________________________________
item_input_layer (InputLayer)   [(None, 1)]          0                                            
__________________________________________________________________________________________________
user_click_cate_seq_input_layer [(None, 50)]         0                                            
__________________________________________________________________________________________________
cate_input_layer (InputLayer)   [(None, 1)]          0                                            
__________________________________________________________________________________________________
concatenate_92 (Concatenate)    (None, 51)           0           user_click_item_seq_input_layer[0
                                                                 item_input_layer[0][0]           
__________________________________________________________________________________________________
item_id_embedding (Embedding)   multiple             320064      user_click_item_seq_input_layer[0
                                                                 item_input_layer[0][0]           
__________________________________________________________________________________________________
cate_id_embedding (Embedding)   multiple             13696       user_click_cate_seq_input_layer[0
                                                                 cate_input_layer[0][0]           
__________________________________________________________________________________________________
tf_op_layer_Equal_3 (TensorFlow [(None, 51)]         0           concatenate_92[0][0]             
__________________________________________________________________________________________________
concatenate_94 (Concatenate)    (None, 51, 64)       0           item_id_embedding[0][0]          
                                                                 item_id_embedding[1][0]          
__________________________________________________________________________________________________
concatenate_95 (Concatenate)    (None, 51, 64)       0           cate_id_embedding[0][0]          
                                                                 cate_id_embedding[1][0]          
__________________________________________________________________________________________________
tf_op_layer_Cast_3 (TensorFlowO [(None, 51)]         0           tf_op_layer_Equal_3[0][0]        
__________________________________________________________________________________________________
user_id_input_layer (InputLayer [(None, 1)]          0                                            
__________________________________________________________________________________________________
gender_input_layer (InputLayer) [(None, 1)]          0                                            
__________________________________________________________________________________________________
age_input_layer (InputLayer)    [(None, 1)]          0                                            
__________________________________________________________________________________________________
concatenate_96 (Concatenate)    (None, 51, 128)      0           concatenate_94[0][0]             
                                                                 concatenate_95[0][0]             
__________________________________________________________________________________________________
tf_op_layer_strided_slice_3 (Te [(None, 1, 1, 51)]   0           tf_op_layer_Cast_3[0][0]         
__________________________________________________________________________________________________
user_id_embedding_layer (Embedd (None, 1, 64)        19264       user_id_input_layer[0][0]        
__________________________________________________________________________________________________
gender_embedding_layer (Embeddi (None, 1, 64)        192         gender_input_layer[0][0]         
__________________________________________________________________________________________________
age_embedding_layer (Embedding) (None, 1, 64)        704         age_input_layer[0][0]            
__________________________________________________________________________________________________
encoder_21 (Encoder)            (None, 51, 128)      659712      concatenate_96[0][0]             
__________________________________________________________________________________________________
concatenate_93 (Concatenate)    (None, 1, 192)       0           user_id_embedding_layer[0][0]    
                                                                 gender_embedding_layer[0][0]     
                                                                 age_embedding_layer[0][0]        
__________________________________________________________________________________________________
tf_op_layer_Reshape_15 (TensorF [(None, 6528)]       0           encoder_21[0][0]                 
__________________________________________________________________________________________________
tf_op_layer_Reshape_14 (TensorF [(None, 192)]        0           concatenate_93[0][0]             
__________________________________________________________________________________________________
concatenate_97 (Concatenate)    (None, 6720)         0           tf_op_layer_Reshape_15[0][0]     
                                                                 tf_op_layer_Reshape_14[0][0]     
__________________________________________________________________________________________________
FC_1 (Dense)                    (None, 2056)         13818376    concatenate_97[0][0]             
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 2056)         0           FC_1[0][0]                       
__________________________________________________________________________________________________
FC_2 (Dense)                    (None, 512)          1053184     dropout_1[0][0]                  
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 512)          0           FC_2[0][0]                       
__________________________________________________________________________________________________
FC_3 (Dense)                    (None, 32)           16416       dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 32)           0           FC_3[0][0]                       
__________________________________________________________________________________________________
Sigmoid_output_layer (Dense)    (None, 1)            33          dropout_3[0][0]                  
==================================================================================================
Total params: 15,901,641
Trainable params: 15,901,641
Non-trainable params: 0
__________________________________________________________________________________________________
None
​

```


# 参考

```python

1. Behavior sequence transformer for e-commerce recommendation in Alibaba

2. https://zhuanlan.zhihu.com/p/161311198
```