# tf.version == '2.1.0'


# run model
```python
DeepFM.ipynb

```


# 模型 summary
```python
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Pclass (InputLayer)             [(None, 1)]          0                                            
__________________________________________________________________________________________________
Sex (InputLayer)                [(None, 1)]          0                                            
__________________________________________________________________________________________________
Cabin (InputLayer)              [(None, 1)]          0                                            
__________________________________________________________________________________________________
Embarked (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
embedding (Embedding)           (None, 1, 64)        256         Pclass[0][0]                     
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 1, 64)        192         Sex[0][0]                        
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 1, 64)        9536        Cabin[0][0]                      
__________________________________________________________________________________________________
embedding_3 (Embedding)         (None, 1, 64)        320         Embarked[0][0]                   
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 1, 256)       0           embedding[0][0]                  
                                                                 embedding_1[0][0]                
                                                                 embedding_2[0][0]                
                                                                 embedding_3[0][0]                
__________________________________________________________________________________________________
Age (InputLayer)                [(None, 1)]          0                                            
__________________________________________________________________________________________________
SibSp (InputLayer)              [(None, 1)]          0                                            
__________________________________________________________________________________________________
Parch (InputLayer)              [(None, 1)]          0                                            
__________________________________________________________________________________________________
Fare (InputLayer)               [(None, 1)]          0                                            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 4)            0           Age[0][0]                        
                                                                 SibSp[0][0]                      
                                                                 Parch[0][0]                      
                                                                 Fare[0][0]                       
__________________________________________________________________________________________________
flatten (Flatten)               (None, 256)          0           concatenate[0][0]                
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 260)          0           flatten[0][0]                    
                                                                 concatenate_1[0][0]              
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 4, 64)        0           embedding[0][0]                  
                                                                 embedding_1[0][0]                
                                                                 embedding_2[0][0]                
                                                                 embedding_3[0][0]                
__________________________________________________________________________________________________
dnn (DNN)                       (None, 128)          49920       concatenate_3[0][0]              
__________________________________________________________________________________________________
linear (Linear)                 (None, 1)            5           concatenate[0][0]                
                                                                 concatenate_1[0][0]              
__________________________________________________________________________________________________
fm (FM)                         (None, 1)            0           concatenate_2[0][0]              
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            128         dnn[0][0]                        
__________________________________________________________________________________________________
add (Add)                       (None, 1)            0           linear[0][0]                     
                                                                 fm[0][0]                         
                                                                 dense[0][0]                      
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            2           add[0][0]                        
==================================================================================================
Total params: 60,359
Trainable params: 60,359
Non-trainable params: 0
__________________________________________________________________________________________________
None

```


# 参考

```python

1. DeepFM: A Factorization-Machine based Neural Network for CTR Prediction

2. https://github.com/shenweichen/DeepCTR
```